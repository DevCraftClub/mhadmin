<?xml version="1.0" encoding="utf-8"?>
<dleplugin>
	<name>MaHarder Assets</name>
	<description>Универсальная административная панель для модификаций от MaHarder</description>
	<icon>engine/inc/maharder/admin/assets/img/admin/icon.png</icon>
	<version>2.0.2 Beta</version>
	<dleversion>13</dleversion>
	<versioncompare>greater</versioncompare>
	<upgradeurl></upgradeurl>
	<filedelete>1</filedelete>
	<needplugin></needplugin>
	<mnotice>0</mnotice>
	<mysqlinstall><![CDATA[]]></mysqlinstall>
	<mysqlupgrade><![CDATA[INSERT INTO {prefix}_admin_sections
(name, title, descr, icon, allow_groups)
VALUES('maharder', 'MaHarder Assets v2.0.2 Beta', 'Административная панель для управления модулями', DEFAULT, '1, 2')
ON DUPLICATE KEY UPDATE title = 'MaHarder Assets v2.0.2 Beta';]]></mysqlupgrade>
	<mysqlenable><![CDATA[INSERT INTO {prefix}_admin_sections
(name, title, descr, icon, allow_groups)
VALUES('maharder', 'MaHarder Assets v2.0.2 Beta', 'Административная панель для управления модулями', DEFAULT, '1, 2')
ON DUPLICATE KEY UPDATE title = 'MaHarder Assets v2.0.2 Beta';]]></mysqlenable>
	<mysqldisable><![CDATA[DELETE FROM {prefix}_admin_sections WHERE name = 'maharder';]]></mysqldisable>
	<mysqldelete><![CDATA[DELETE FROM {prefix}_admin_sections WHERE name = 'maharder';]]></mysqldelete>
	<phpinstall><![CDATA[]]></phpinstall>
	<phpupgrade><![CDATA[$objects = scandir(ENGINE_DIR . '/skins/maharder');
foreach ($objects as $object) {
	if ($object != "." && $object != "..") {
    	if (filetype(ENGINE_DIR . '/skins/maharder'."/".$object) == "dir")
          @rmdir(ENGINE_DIR . '/skins/maharder'."/".$object); 
      	else
          @unlink(ENGINE_DIR . '/skins/maharder'."/".$object);
	}
}
reset($objects);
@rmdir(ENGINE_DIR . '/skins/maharder');

$objects = scandir(ENGINE_DIR . '/inc/maharder/assets');
foreach ($objects as $object) {
	if ($object != "." && $object != "..") {
    	if (filetype(ENGINE_DIR . '/inc/maharder/assets'."/".$object) == "dir")
          @rmdir(ENGINE_DIR . '/inc/maharder/assets'."/".$object); 
      	else
          @unlink(ENGINE_DIR . '/inc/maharder/assets'."/".$object);
	}
}
reset($objects);
@rmdir(ENGINE_DIR . '/inc/maharder/assets');

$objects = scandir(ENGINE_DIR . '/inc/maharder/maharder');
foreach ($objects as $object) {
	if ($object != "." && $object != "..") {
    	if (filetype(ENGINE_DIR . '/inc/maharder/maharder'."/".$object) == "dir")
          @rmdir(ENGINE_DIR . '/inc/maharder/maharder'."/".$object); 
      	else
          @unlink(ENGINE_DIR . '/inc/maharder/maharder'."/".$object);
	}
}
reset($objects);
@rmdir(ENGINE_DIR . '/inc/maharder/maharder');]]></phpupgrade>
	<phpenable><![CDATA[]]></phpenable>
	<phpdisable><![CDATA[]]></phpdisable>
	<phpdelete><![CDATA[]]></phpdelete>
	<notice><![CDATA[]]></notice>
	<file name="engine/inc/include/functions.inc.php">
		<operation action="replace">
			<searchcode><![CDATA['engine/skins/fonts/fontawesome/styles.min.css',]]></searchcode>
			<replacecode><![CDATA['engine/inc/maharder/admin/assets/css/fa_fix.css',
'engine/inc/maharder/admin/assets/css/fa_old.css',
'engine/inc/maharder/admin/assets/css/icons.css',]]></replacecode>
			<searchcount>1</searchcount>
			<enabled>1</enabled>
		</operation>
	</file>
	<file name="engine/skins/default.skin.php">
		<operation action="before">
			<searchcode><![CDATA[<a href="?mod=addnews&amp;action=addnews" class="btn btn-link btn-float text-size-small has-text"><i class="fa fa-file-text-o text-primary"></i> <span>{$lang['add_news']}</span></a>]]></searchcode>
			<replacecode><![CDATA[								<a rel="button" class="btn btn-link btn-float text-size-small has-text clear_cache">
									<i class="fa fa-trash text-danger-600"></i> 
									<span class="text-danger-600">{$lang['btn_clearcache']}</span>
								</a>]]></replacecode>
			<enabled>1</enabled>
		</operation>
		<operation action="before">
			<searchcode><![CDATA[</body>]]></searchcode>
			<replacecode><![CDATA[<script>
		$(function(){

			$('.clear_cache').click(function() {
				ShowLoading();

				$.get("engine/ajax/controller.php?mod=adminfunction&action=clearcache&user_hash={$dle_login_hash}", function( data ){

					Growl.info({
						title: '{$lang['p_info']}',
						text: data
					});
                  	HideLoading();

				});
				return false;
			});
		});
</script>
]]></replacecode>
			<enabled>1</enabled>
		</operation>
	</file>
</dleplugin>